{% extends 'dashboard/base.html' %}

{% block title %}حذف کوچ - پنل مدیریت{% endblock %}
{% block page_title %}حذف کوچ{% endblock %}

{% block content %}
<div class="max-w-2xl">
    <div class="bg-white rounded-lg shadow-sm border border-red-200">
        <!-- Header -->
        <div class="p-6 border-b border-red-200 bg-red-50">
            <div class="flex items-center gap-3">
                <div class="p-3 bg-red-100 rounded-lg">
                    <i data-lucide="alert-triangle" class="w-6 h-6 text-red-600"></i>
                </div>
                <div>
                    <h2 class="text-xl font-semibold text-red-800">تایید حذف</h2>
                    <p class="text-sm text-red-600 mt-1">آیا از حذف این کوچ اطمینان دارید؟</p>
                </div>
            </div>
        </div>

        <!-- Content -->
        <div class="p-6">
            <!-- Coach Info -->
            <div class="bg-gray-50 rounded-lg p-4 mb-6">
                <div class="flex items-center gap-4 mb-4">
                    <div class="w-16 h-16 rounded-full bg-gradient-to-br from-blue-500 to-purple-600 flex items-center justify-center text-white font-bold text-xl">
                        {{ coach.user.username|slice:":2"|upper }}
                    </div>
                    <div>
                        <p class="text-sm text-gray-600">کوچ:</p>
                        <p class="text-lg font-semibold text-gray-900">{{ coach.user.username }}</p>
                        <p class="text-sm text-gray-600">{{ coach.user.email }}</p>
                    </div>
                </div>

                <div class="grid grid-cols-2 gap-4 pt-4 border-t border-gray-200">
                    <div>
                        <p class="text-xs text-gray-500 mb-1">وضعیت:</p>
                        {% if coach.enable %}
                            <span class="inline-flex items-center gap-1 px-2 py-1 bg-green-100 text-green-700 rounded text-xs">
                                <i data-lucide="check-circle" class="w-3 h-3"></i>
                                فعال
                            </span>
                        {% else %}
                            <span class="inline-flex items-center gap-1 px-2 py-1 bg-red-100 text-red-700 rounded text-xs">
                                <i data-lucide="x-circle" class="w-3 h-3"></i>
                                غیرفعال
                            </span>
                        {% endif %}
                    </div>
                    <div>
                        <p class="text-xs text-gray-500 mb-1">ساعات بازی:</p>
                        <p class="text-sm font-medium text-gray-900">{{ coach.timeplay }} ساعت</p>
                    </div>
                </div>
            </div>

            <!-- Description Preview -->
            <div class="bg-gray-50 rounded-lg p-4 mb-6 border border-gray-200">
                <p class="text-xs text-gray-500 mb-2">توضیحات:</p>
                <p class="text-sm text-gray-700 line-clamp-3">{{ coach.description }}</p>
            </div>

            <!-- Statistics -->
            <div class="grid grid-cols-3 gap-4 mb-6">
                <div class="bg-blue-50 border border-blue-200 rounded-lg p-4 text-center">
                    <div class="mx-auto w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center mb-2">
                        <i data-lucide="layers" class="w-5 h-5 text-blue-600"></i>
                    </div>
                    <p class="text-xs text-blue-600 mb-1">Expansions</p>
                    <p class="text-2xl font-bold text-blue-900">{{ coach.expansions.count }}</p>
                </div>

                <div class="bg-purple-50 border border-purple-200 rounded-lg p-4 text-center">
                    <div class="mx-auto w-10 h-10 bg-purple-100 rounded-lg flex items-center justify-center mb-2">
                        <i data-lucide="zap" class="w-5 h-5 text-purple-600"></i>
                    </div>
                    <p class="text-xs text-purple-600 mb-1">Methods</p>
                    <p class="text-2xl font-bold text-purple-900">{{ coach.methods.count }}</p>
                </div>

                <div class="bg-orange-50 border border-orange-200 rounded-lg p-4 text-center">
                    <div class="mx-auto w-10 h-10 bg-orange-100 rounded-lg flex items-center justify-center mb-2">
                        <i data-lucide="message-square" class="w-5 h-5 text-orange-600"></i>
                    </div>
                    <p class="text-xs text-orange-600 mb-1">کامنت‌ها</p>
                    <p class="text-2xl font-bold text-orange-900">{{ comments_count }}</p>
                </div>
            </div>

            <!-- Warning Box -->
            <div class="bg-red-50 border border-red-200 rounded-lg p-4 mb-6">
                <div class="flex gap-3">
                    <i data-lucide="alert-octagon" class="w-5 h-5 text-red-600 flex-shrink-0 mt-0.5"></i>
                    <div>
                        <p class="text-sm font-medium text-red-800">هشدار مهم!</p>
                        <ul class="text-sm text-red-700 mt-2 space-y-1">
                            <li class="flex items-start gap-2">
                                <span class="text-red-500">•</span>
                                <span>این عملیات قابل بازگشت نیست</span>
                            </li>
                            {% if comments_count > 0 %}
                            <li class="flex items-start gap-2">
                                <span class="text-red-500">•</span>
                                <span><strong>{{ comments_count }} کامنت</strong> مرتبط با این کوچ نیز حذف خواهند شد</span>
                            </li>
                            {% endif %}
                            <li class="flex items-start gap-2">
                                <span class="text-red-500">•</span>
                                <span>کاربر {{ coach.user.username }} همچنان در سیستم باقی می‌ماند ولی دیگر کوچ نخواهد بود</span>
                            </li>
                            <li class="flex items-start gap-2">
                                <span class="text-red-500">•</span>
                                <span>تمام اطلاعات مربوط به Expansions و Methods این کوچ حذف می‌شود</span>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>

            <!-- Confirmation Info -->
            <div class="bg-yellow-50 border border-yellow-200 rounded-lg p-4 mb-6">
                <div class="flex gap-3">
                    <i data-lucide="info" class="w-5 h-5 text-yellow-600 flex-shrink-0 mt-0.5"></i>
                    <div class="text-sm text-yellow-800">
                        <p class="font-medium mb-1">در صورت نیاز:</p>
                        <p class="text-yellow-700">می‌توانید در آینده مجدداً همین کاربر را به عنوان کوچ ثبت کنید.</p>
                    </div>
                </div>
            </div>

            <!-- Expansions & Methods Preview -->
            <div class="grid grid-cols-2 gap-4 mb-6">
                <div class="bg-gray-50 rounded-lg p-3 border border-gray-200">
                    <p class="text-xs font-medium text-gray-600 mb-2">Expansions انتخاب شده:</p>
                    <div class="flex flex-wrap gap-1">
                        {% for expansion in coach.expansions.all|slice:":5" %}
                            <span class="inline-block px-2 py-1 bg-blue-100 text-blue-700 rounded text-xs">
                                {{ expansion.name }}
                            </span>
                        {% endfor %}
                        {% if coach.expansions.count > 5 %}
                            <span class="inline-block px-2 py-1 bg-gray-200 text-gray-700 rounded text-xs">
                                +{{ coach.expansions.count|add:"-5" }}
                            </span>
                        {% endif %}
                    </div>
                </div>

                <div class="bg-gray-50 rounded-lg p-3 border border-gray-200">
                    <p class="text-xs font-medium text-gray-600 mb-2">Methods انتخاب شده:</p>
                    <div class="flex flex-wrap gap-1">
                        {% for method in coach.methods.all|slice:":5" %}
                            <span class="inline-block px-2 py-1 bg-purple-100 text-purple-700 rounded text-xs">
                                {{ method.name }}
                            </span>
                        {% endfor %}
                        {% if coach.methods.count > 5 %}
                            <span class="inline-block px-2 py-1 bg-gray-200 text-gray-700 rounded text-xs">
                                +{{ coach.methods.count|add:"-5" }}
                            </span>
                        {% endif %}
                    </div>
                </div>
            </div>

            <!-- Form -->
            <form method="POST">
                {% csrf_token %}
                
                <div class="flex items-center gap-3">
                    <button 
                        type="submit" 
                        class="px-6 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors flex items-center gap-2"
                    >
                        <i data-lucide="trash-2" class="w-4 h-4"></i>
                        <span>بله، حذف قطعی</span>
                    </button>
                    
                    <a 
                        href="{% url 'dashboard:coach_detail' coach.id %}" 
                        class="px-6 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors flex items-center gap-2"
                    >
                        <i data-lucide="arrow-right" class="w-4 h-4"></i>
                        <span>انصراف و بازگشت</span>
                    </a>
                </div>
            </form>
        </div>
    </div>
</div>
{% endblock %}